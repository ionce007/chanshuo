<% if(config.allow_comments === 'true' && page.commentStatus === 1){ %>
    <% if(config.disqus !== undefined && config.disqus !== "") { %>
    <div id="disqus_thread"></div>
    <link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet' />
    <script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script>
    
    <script>
      const params = new URLSearchParams(location.search.slice(1));
      const locale = {
        nick: '昵称',
        nickError: '昵称不能少于3个字符',
        mail: '邮箱',
        mailError: '请填写正确的邮件地址',
        link: '网址',
        optional: '可选',
        placeholder: '欢迎评论(支持匿名评论，支持 Markdown 语法)',
        sofa: '来发评论吧~',
        submit: '提交',
        like: '喜欢',
        cancelLike: '取消喜欢',
        reply: '回复',
        cancelReply: '取消回复',
        comment: '评论',
        refresh: '刷新',
        more: '加载更多...',
        preview: '预览',
        emoji: '表情',
        uploadImage: '上传图片',
        seconds: '秒前',
        minutes: '分钟前',
        hours: '小时前',
        days: '天前',
        now: '刚刚',
        uploading: '正在上传',
        login: '登录',
        logout: '退出',
        admin: '博主',
        sticky: '置顶',
        word: '字',
        wordHint: '评论字数应在 $0 到 $1 字之间！\n当前字数：$2',
        anonymous: '匿名',
        level0: '潜水',
        level1: '冒泡',
        level2: '吐槽',
        level3: '活跃',
        level4: '话痨',
        level5: '传说',
        gif: '表情包',
        gifSearchPlaceholder: '搜索表情包',
        profile: '个人资料',
        approved: '通过',
        waiting: '待审核',
        spam: '垃圾',
        unsticky: '取消置顶',
        oldest: '按倒序',
        latest: '按正序',
        hottest: '按热度',
        reactionTitle: '你认为这篇文章怎么样？',
      };
      const waline = Waline.init({
        el: '#disqus_thread',
        //path: params.get('path') || '/',
        //lang: params.get('lng'),
        serverURL: 'https://waline-1-j2273384.deta.app/',
        recaptchaV3Key: '',
        turnstileKey: '',
        reaction: true,
        pageview: true,
        comment: true,
        provider: 'Waline',
        locale: locale,
        highlighter: (code, lang) => {
          if (!window.Prism.languages[lang]) {
            window.Prism.plugins.autoloader.loadLanguages(lang);
          }
          return window.Prism.highlight(
            code,
            window.Prism.languages[lang] || window.Prism.languages.text,
            lang,
          );
        },
      });
      /*
      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.setAttribute('issue-term','pathname');
        s.setAttribute('theme','github-light');
        s.setAttribute('repo','<%= config.disqus %>');
        s.crossorigin = 'anonymous';
        s.src = 'https://utteranc.es/client.js';
        s.setAttribute('data-timestamp', +new Date());
        document.getElementById('disqus_thread').appendChild(s);
        //(d.head || d.body).appendChild(s);
      })();*/
    </script>
    <% } %>
<% } %>
